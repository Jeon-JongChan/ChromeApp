<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>í¬ì¼“ëª¬ ëœë¤ í˜ì´ì§€</title>
    <link rel="stylesheet" type="text/css" href="css/admin.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- <link rel="stylesheet" type="text/css" href="css/admin.css"> -->
    <script src="config.js" type="text/javascript"></script>
    <script src="data.js" type="text/javascript"></script>
    <script src="js/firebase.js" type="text/javascript"></script>
    <script src="js/public.js" type="text/javascript"></script>
    <script src="js/admin.js" type="text/javascript"></script>
    <script src="js/main.js" type="text/javascript"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-storage.js"></script>
    <script>
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      const storage = firebase.storage();
    </script>
  </head>
  <body>
    <!-- <img class="logo" src="logo.png" width="200px" style="margin-bottom: 10px;"> -->
    <nav class="menu">
      <a class="change-menu" style="background-color: rgba(200,0,0,0.3);" onclick="changeMenu('admin')">ADMIN</a>
      <a class="change-menu" style="background-color: rgba(0,200,0,0.3);" onclick="changeMenu('main')">MAIN</a>
      <a class="change-menu" style="background-color: rgba(0,0,200,0.3);" onclick="changeMenu('battle')">BATTLE</a>
    </nav>
    <div id="battle">
      <div class="first-input">
        <label for="bname1">ì„ ê³µí¬ì¼“ëª¬</label>
        <input id="bname1" type="text" value="">
        <label for="bskill1">ì‚¬ìš©ê¸°ìˆ </label>
        <input id="bskill1" type="text" value="">
        <label for="bhealth1">í˜„ì¬ì²´ë ¥</label>
        <input id="bhealth1" type="number" value=100>
        <label for="bdamage1">ë°ë¯¸ì§€ìƒì„±</label>
        <select name="damage" id="bdamage1">
          <option value="0">x0</option>
          <option value="1">x0.25</option>
          <option value="2">x0.5</option>
          <option value="3" selected>x1.0</option>
          <option value="4">x2.0</option>
          <option value="5">x4.0</option>
        </select>
      </div>
      <div class="second-input">
        <label for="bname2">í›„ê³µí¬ì¼“ëª¬</label>
        <input id="bname2" type="text" value="">
        <label for="bskill2">ì‚¬ìš©ê¸°ìˆ </label>
        <input id="bskill2" type="text" value="">
        <label for="bhealth2">í˜„ì¬ì²´ë ¥</label>
        <input id="bhealth2" type="number" value=100>
        <label for="bdamage2">ë°ë¯¸ì§€ìƒì„±</label>
        <select name="damage" id="bdamage2">
          <option value="0">x0</option>
          <option value="1">x0.25</option>
          <option value="2">x0.5</option>
          <option value="3" selected>x1.0</option>
          <option value="4">x2.0</option>
          <option value="5">x4.0</option>
        </select>
      </div>
      <div class="battle-dialoger half-div">
        <button class="generator-btn" onclick="genBattleDialog()">ì „íˆ¬ ë°ë¯¸ì§€ ë¡œê·¸ ìƒì„±ê¸°</button>
        <button class="generator-btn" onclick="copyToClipBoard('.battle-dialog')">Copy</button>
        <div class="battle-dialog">
          <div style="font-size: 16px; text-align: center;">
            ğŸ’¥&nbsp;<span class="bd-name1"></span>ì˜&nbsp;<span class="bd-skill1"></span>!<br>
            <span class="bd-effect1"></span>&nbsp;-(<span class="bd-damage1"></span>)%
            <br><br>
            ğŸ’¥&nbsp;ìƒëŒ€&nbsp;<span class="bd-name2"></span>ì˜&nbsp;<span class="bd-skill2"></span>!<br>
            <span class="bd-effect2"></span>&nbsp;-(<span class="bd-damage2"></span>)%
            <br><br>
            <span class="bd-name1"></span>&nbsp;: ë‚¨ì€ì²´ë ¥&nbsp;<span class="bd-health1"></span>%<br>
            <span class="bd-name2"></span>&nbsp;: ë‚¨ì€ì²´ë ¥&nbsp;<span class="bd-health2"></span>%<br>
            â–¶ ë‹¤ìŒì€ ë¬´ì—‡ì„ í• ê¹Œ?
          </div>
        </div>
      </div>
      <script>
        function genBattleDialog() {
          let battle = document.querySelector('#battle');
          let effectDialog = [
            "íš¨ê³¼ê°€ ì—†ëŠ” ê²ƒ ê°™ë‹¤...",
            "íš¨ê³¼ê°€ ë§¤ìš° ë¶€ì¡±í•œ ê²ƒ ê°™ë‹¤...",
            "íš¨ê³¼ê°€ ë¶€ì¡±í•œ ê²ƒ ê°™ë‹¤...",
            '',
            "íš¨ê³¼ê°€ êµ‰ì¥í–ˆë‹¤!",
            "íš¨ê³¼ê°€ ë§¤ìš° êµ‰ì¥í–ˆë‹¤!"
          ]
          let input1 = {
            name: battle.querySelector("#bname1").value,
            skill: battle.querySelector("#bskill1").value,
            health: battle.querySelector("#bhealth1").value,
            damage: battle.querySelector("#bdamage1").value,
          }
          let input2 = {
            name: battle.querySelector("#bname2").value,
            skill: battle.querySelector("#bskill2").value,
            health: battle.querySelector("#bhealth2").value,
            damage: battle.querySelector("#bdamage2").value,
          }
          if(!input1.name || !input2.name) {
            alert("í¬ì¼“ëª¬ ì´ë¦„ì´ ë‹¤ ì±„ì›Œì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
            return null;
          }
          if(!input1.skill || !input2.skill) {
            alert("í¬ì¼“ëª¬ ê¸°ìˆ ì´ ë‹¤ ì±„ì›Œì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
            return null;
          }

          var names = battle.querySelectorAll('.bd-name1');
          let damage1 = battleDamage(input1.damage);
          let damage2 = battleDamage(input2.damage);

          names[0].innerText = input1.name;
          names[1].innerText = input1.name;
          battle.querySelector('.bd-skill1').innerText = input1.skill;
          battle.querySelector('.bd-damage1').innerText = damage1;
          battle.querySelector('.bd-effect1').innerText = effectDialog[input1.damage*1];
          battle.querySelector('.bd-health1').innerText = input1.health-damage2;
          
          names = battle.querySelectorAll('.bd-name2');
          names[0].innerText = input2.name;
          names[1].innerText = input2.name;
          battle.querySelector('.bd-skill2').innerText = input2.skill;
          battle.querySelector('.bd-damage2').innerText = damage2;
          battle.querySelector('.bd-effect2').innerText = effectDialog[input2.damage*1];
          battle.querySelector('.bd-health2').innerText = input2.health-damage1;
        }
        function battleDamage(option = 3) {
          if(option==="0") return 0
          else if(option==="1") return getRandomInt(0,10+1)
          else if(option==="2") return getRandomInt(11,20+1)
          else if(option==="3") return getRandomInt(21,40+1)
          else if(option==="4") return getRandomInt(41,70+1)
          else if(option==="5") return getRandomInt(71,90+1)
        }
      </script>
    </div>
    <div id="main">
      <div class="player-local">
        <label for="player">í”Œë ˆì´ì–´</label>
        <input id="player" type="text" value="">
        <label for="local">ì§€ì—­</label>
        <input id="local" type="text" value="">
      </div>
      <div class="selected">
        <label for="selected-poketmon">ì„ íƒë°›ì€ í¬ì¼“ëª¬</label>
        <input id="selected-poketmon" type="text" value="">
      </div>
      <div class="youtube">
        <label for="youtube-url">ì²¨ë¶€í•  ìœ íˆ¬ë¸Œ ìŒì•… ì£¼ì†Œ</label>
        <input id="youtube-url" type="text" value="youtu.be/Q9qzH58HtHM">
      </div>
      <div class="plevel">
        <label for="plevel-min">ë ˆë²¨ ìµœì†Œ ë²”ìœ„</label>
        <input id="plevel-min" type="number" value="1">
        <label for="plevel-max">ë ˆë²¨ ìµœëŒ€ ë²”ìœ„</label>
        <input id="plevel-max" type="number" value="50">
      </div>
      <div class="poket-dialog">
        <div class="poketmon-selector half-div">
          <button class="generator-btn" onclick="genPoketSelector()">í¬ì¼“ëª¬ ëœë¤ ìƒì„±ê¸°</button>
          <button class="generator-btn" onclick="copyToClipBoard('.poketmon-select')">Copy</button>
          <div class="poketmon-select">
            <p style="font-size: 16px;">
              â™«<span class="music"></span><br>
              ì•¼ìƒì˜ í¬ì¼“ëª¬ì´ ë‚˜íƒ€ë‚¬ì–´. <span class="player1"></span>...<br><br>
              ...ëˆ„êµ¬ë¥¼ ë¦¬ì„œì¹˜ í•´ë³¼ê¹Œ <span class="player2"></span>?<br>
              &#9654;<span class="poket1">ëŒì‚´ì´</span><br>
              &#9654;<span class="poket2">ë¼ë¦¬ë™</span><br>
            </p>
            <img id="poket1-img" width="49%" src="">
            <img id="poket2-img" width="49%" src="">
          </div>
        </div>
        <div class="poketmon-battler half-div">
          <button class="generator-btn" onclick="genPoketBattle()">í¬ì¼“ëª¬ ì „íˆ¬ ëŒ€ì‚¬ ìƒì„±ê¸°</button>
          <button class="generator-btn" onclick="copyToClipBoard('.poketmon-battle')">Copy</button>
          <div class="poketmon-battle">
            <p style="font-size: 16px;">
              â™«<span class="music"></span><br><br>
              ì•¼ìƒì˜ 
              <span class="pspec"></span>
              <span class="pname"></span>ê°€ ë‚˜íƒ€ë‚¬ì–´.<br><br>
              Lv.&nbsp;<span class="plevel"></span>&nbsp;[&nbsp;<span class="ppersonal"></span>&nbsp;]<br><br>
              <span class="player1"></span>ëŠ” ë¬´ì—‡ì„ í• ê¹Œ?<br><br>
              &#9654; ì‹¸ìš´ë‹¤<br>
              &#9654; ëŒ€í™”í•œë‹¤(í”„ë Œë“œë³¼ ì „ìš©)<br>
              &#9654; ëª¬ìŠ¤í„°ë³¼<br>
              &#9654; ë„ë§ì¹œë‹¤<br>
            </p>
            <img id="poket-img" width="100%">
          </div>
        </div>
      </div>
    </div>
    <style>
      .search {
        display: inline-block;
        width: 120px;
      }
      .search-list {
        width: 100%;
        height: 50px;
        overflow-x: scroll;
        -ms-overflow-style: none;
        -chrome-overflow-style: none;
        border: 1px solid black;
      }
      .search-list::-webkit-scrollbar{
         display:none; 
      }
      .local-search {
        width: 100%;
      }
      .local-search .search-box {
        float: right;
      }
    </style>
    <script>
      function searchLocalPoketmon(){
        let searchLocal = document.querySelector("#input-search").value;
        let paranetNode = document.querySelector(".search-list");
        if(paranetNode.childElementCount > 0) {
          let deleteNodes = paranetNode.childNodes;
          while(deleteNodes.length > 1) {
            deleteNodes[1].remove();
          }
        }

        let template = document.querySelector("template").content.querySelector(".search");
        let names = []
        for(let i=0; i<json.poketmon.length; i++) {
          let poketmon = json.poketmon[i];
          if(searchLocal === poketmon.local) {
            names.push(poketmon.name);
          }
        }
        for(let i=0; i<names.length; i++) {
          let dom = template.cloneNode(true);
          dom.querySelector(".search-name").innerText = names[i];
          paranetNode.appendChild(dom);
        }

      }
      function nodeSearch(search, templateNode=null) {
        if(!templateNode) {
          templateNode = document.querySelector("template").content.querySelector(".search");
        }
        let dom = templateNode.cloneNode(true);
        let name = spec.name;
        dom.querySelector(".spec-name").innerText = name;
        return dom;
      }
    </script>
    <div id="admin">
      <div class="frame" style="min-height: 100px;">
        <article style="width:100%;">
          <h1 class="list-header">í¬ì¼“ëª¬ ì§€ì—­ë³„ ë“±ë¡ ê²€ìƒ‰ì°½</h1>
          <div class="local-search">
            <input id="input-search" class="input-text" type="text"/>
            <button class="search-btn" onclick="searchLocalPoketmon()">ê²€ìƒ‰</button>
          </div>
          <div class="search-list">    
          </div>
        </article>
      </div>
      <div class="frame">
        <article class="article-left">
            <h1 class="list-header">í¬ì¼“ëª¬ ë¦¬ìŠ¤íŠ¸</h1>
            <div class="poketmon-list">
            </div>
        </article>
        <article class="article-center input-item">
          <section class="add-poketmon">
            <div class="additem add-poketname">
              <label for="p-add-name" class="add-header">í¬ì¼“ëª¬ ì´ë¦„ :</label>
              <input class="input-text" id="p-add-name" type="text"/>
            </div>
            <div class="additem add-poketimage">
              <label class="add-header">ì´ë¯¸ì§€ :</label>
              <div class="input-file">
                <input id="image-poketmon" type="file"/>
              </div>
            </div>
            <div class="additem add-local">
              <label for="p-add-local" class="add-header">ì¶œëª°ì§€ :</label>
              <input class="input-text" id="p-add-local" type="text"/>
            </div>
            <div class="additem add-rare">
              <label class="add-header">ì¶œí˜„ìœ¨ :</label>
              <input class="input-text" type="number"/>
            </div>
            <div class="additem add-poket-type">
              <label for="p-add-type" class="add-header">í¬ì¼“ëª¬ íƒ€ì… :</label>
              <input class="input-text" id="p-add-type" type="text"/>
            </div>
            <div class="additem add-personal">
              <label for="p-add-personal" class="add-header">í¬ì¼“ëª¬ íŠ¹ì„±1 :</label>
              <input class="input-text" id="p-add-personal" type="text"/>
            </div>
            <div class="additem add-personal">
              <label for="p-add-personal2" class="add-header">í¬ì¼“ëª¬ íŠ¹ì„±2 :</label>
              <input class="input-text" id="p-add-personal2" type="text"/>
            </div>
            <div class="additem add-personal">
              <label for="p-add-hidden" class="add-header">ìˆ¨ê²¨ì§„ íŠ¹ì„± :</label>
              <input class="input-text" id="p-add-hidden" type="text"/>
            </div>
          </section>
          <div class="buttons">
            <button id="add-poketmon-btn" onclick="addPoketmon()">ì¶”ê°€</button>
          </div>
        </article>
      </div>
      <div class="frame">
        <article class="article-left">
          <h1 class="list-header">ì¶œëª° ì§€ì—­ ì°¸ì¡° ë¦¬ìŠ¤íŠ¸ <span class="help-text">ìˆ«ìëŠ” ì§€ì—­ì— ì¡´ì¬í•˜ëŠ” í¬ì¼“ëª¬ ìˆ˜</span></h1>
          <div class="local-list">
          </div>
        </article>
        <article class="article-center input-item">
          <section class="add-poketmon">
            <div class="additem add-local-name">
              <label  class="add-header">í¬ì¼“ëª¬ ì¶œëª°ì§€ :</label>
              <input class="input-text" type="text"/>
            </div>
          </section>
          <div class="buttons">
            <button id="add-spec-btn" onclick="addLocal()">ì¶”ê°€</button>
          </div>
        </article>
      </div>
      <div class="frame">
        <article class="article-left">
          <h1 class="list-header">í¬ì¼“ëª¬ ì„±ê²© ë¦¬ìŠ¤íŠ¸</h1>
          <div class="spec-list">
          </div>
        </article>
        <article class="article-center input-item">
          <section class="add-poketmon">
            <div class="additem add-spec-name">
              <label class="add-header">í¬ì¼“ëª¬ ì„±ê²© :</label>
              <input class="input-text" type="text"/>
            </div>
          </section>
          <div class="buttons">
            <button id="add-spec-btn" onclick="addSpec()">ì¶”ê°€</button>
          </div>
        </article>
      </div>
    </div>
    <template>
      <section class="poketmon">
        <div class="poket-img">
          <div class="poket-modal">
            <div class="poket-line">
              <h3 class="poket-name"></h3>
            </div>
            <div class="poket-line">
              <span class="left">íƒ€ì… :</span>&nbsp;
              <span class="right poket-type"></span>
            </div>
            <div class="poket-line">
              <span class="left">íŠ¹ì„± :</span>&nbsp;
              <span class="right poket-personal"></span>
            </div>
            <div class="poket-line">
              <span class="left">íˆë“ íŠ¹ì„±</span>&nbsp;
              <span class="right poket-personal-hidden"></span>
            </div>
            <div class="poket-line">
              <span class="left">ì§€ì—­ :</span>&nbsp;
              <span class="right poket-local"></span>
            </div>
            <div class="poket-line">
              <span class="left">ì¶œí˜„ìœ¨ :</span>&nbsp;
              <span class="right poket-rare"></span>%
            </div>
          </div>
        </div>
        <button style="width: 100%;" class="delete-btn" onclick="deletePoketData('poketmon')">X</button>
      </section>
      <section class="local">
        <span class="local-name"></span>&nbsp;<span class="local-count"></span>&nbsp;
        <button class="delete-btn" onclick="deletePoketData('local')">X</button>
      </section>
      <section class="spec">
        <!-- ì„±ê²© :&nbsp; -->
        <span class="spec-name"></span>&nbsp;&nbsp;
        <button class="delete-btn" onclick="deletePoketData('spec')">X</button>
      </section>
      <section class="search">
        <span class="search-name"></span>&nbsp;
      </section>
    </template>
    <script>
      initAdminPage();
      changeMenu('main');
    </script>
  </body>
</html>